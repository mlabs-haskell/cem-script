<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NoPolyKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- This warnings work incorrectly in presence of our Plutus code</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unrecognised-pragmas #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-local-binds #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# HLINT ignore &quot;Redundant bracket&quot; #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.CEM.OnChain</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><a href="Cardano.CEM.OnChain.html#CEMScriptCompiled"><span class="hs-identifier">CEMScriptCompiled</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><a href="Cardano.CEM.OnChain.html#cemScriptAddress"><span class="hs-identifier">cemScriptAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Cardano.CEM.OnChain.html#genericCEMScript"><span class="hs-identifier">genericCEMScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Prelude.html"><span class="hs-identifier">PlutusTx.Prelude</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">conT</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Exp</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Q</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.Common.html"><span class="hs-identifier">PlutusLedgerApi.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.Common.SerialisedScript.html#SerialisedScript"><span class="hs-identifier">SerialisedScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Address.html"><span class="hs-identifier">PlutusLedgerApi.V1.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Address.html#Address"><span class="hs-identifier">Address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Address.html#scriptHashAddress"><span class="hs-identifier">scriptHashAddress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Interval.html"><span class="hs-identifier">PlutusLedgerApi.V1.Interval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Interval.html#always"><span class="hs-identifier">always</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Interval.html#contains"><span class="hs-identifier">contains</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Scripts.html"><span class="hs-identifier">PlutusLedgerApi.V1.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Scripts.html#Datum"><span class="hs-identifier">Datum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Value.html"><span class="hs-identifier">PlutusLedgerApi.V1.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Value.html#geq"><span class="hs-identifier">geq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html"><span class="hs-identifier">PlutusLedgerApi.V2.Contexts</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#TxInInfo"><span class="hs-identifier">TxInInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#TxInfo"><span class="hs-identifier">TxInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#TxOut"><span class="hs-identifier">TxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#findOwnInput"><span class="hs-identifier">findOwnInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#scriptContextTxInfo"><span class="hs-identifier">scriptContextTxInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html"><span class="hs-identifier">PlutusLedgerApi.V2.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#OutputDatum"><span class="hs-identifier">OutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.html"><span class="hs-identifier">PlutusTx.IsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#FromData"><span class="hs-identifier">FromData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#ToData"><span class="hs-identifier">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#toBuiltinData"><span class="hs-identifier">toBuiltinData</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#UnsafeFromData"><span class="hs-identifier">UnsafeFromData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Show.html"><span class="hs-identifier">PlutusTx.Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Show.TH.html#Show"><span class="hs-identifier">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.CEM.html"><span class="hs-identifier">Cardano.CEM</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.CEM.Stages.html"><span class="hs-identifier">Cardano.CEM.Stages</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/gregory/Programming/cem-script/dist-newstyle/build/x86_64-linux/ghc-9.6.3/cem-script-0.1.0/l/cardano-extras/doc/html/cem-script/src/Plutus.Extras.html"><span class="hs-identifier">Plutus.Extras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/Programming/cem-script/dist-newstyle/build/x86_64-linux/ghc-9.6.3/cem-script-0.1.0/l/cardano-extras/doc/html/cem-script/src/Plutus.Extras.html#scriptValidatorHash"><span class="hs-identifier">scriptValidatorHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#CEMScript"><span class="hs-identifier hs-type">CEMScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556834"><span class="hs-identifier hs-type">script</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#CEMScriptIsData"><span class="hs-identifier hs-type">CEMScriptIsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556834"><span class="hs-identifier hs-type">script</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="CEMScriptCompiled"><span class="annot"><a href="Cardano.CEM.OnChain.html#CEMScriptCompiled"><span class="hs-identifier hs-var">CEMScriptCompiled</span></a></span></span><span> </span><span id="local-6989586621679556834"><span class="annot"><a href="#local-6989586621679556834"><span class="hs-identifier hs-type">script</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>  </span><span id="cemScriptCompiled"><span class="annot"><a href="Cardano.CEM.OnChain.html#cemScriptCompiled"><span class="hs-identifier hs-type">cemScriptCompiled</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679556834"><span class="hs-identifier hs-type">script</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.Common.SerialisedScript.html#SerialisedScript"><span class="hs-identifier hs-type">SerialisedScript</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#cemScriptAddress"><span class="hs-pragma hs-type">cemScriptAddress</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Cardano.CEM.OnChain.html#cemScriptAddress"><span class="hs-identifier hs-type">cemScriptAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679556838"><span class="annot"><a href="#local-6989586621679556838"><span class="hs-identifier hs-type">script</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.OnChain.html#CEMScriptCompiled"><span class="hs-identifier hs-type">CEMScriptCompiled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556838"><span class="hs-identifier hs-type">script</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679556838"><span class="hs-identifier hs-type">script</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Address.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span>
</span><span id="line-46"></span><span id="cemScriptAddress"><span class="annot"><span class="annottext">cemScriptAddress :: forall script. CEMScriptCompiled script =&gt; Proxy script -&gt; Address
</span><a href="Cardano.CEM.OnChain.html#cemScriptAddress"><span class="hs-identifier hs-var hs-var">cemScriptAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="annottext">ScriptHash -&gt; Address
</span><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Address.html#scriptHashAddress"><span class="hs-identifier hs-var">scriptHashAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptHash -&gt; Address)
-&gt; (Proxy script -&gt; ScriptHash) -&gt; Proxy script -&gt; Address
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SerialisedScript -&gt; ScriptHash
</span><a href="file:///home/gregory/Programming/cem-script/dist-newstyle/build/x86_64-linux/ghc-9.6.3/cem-script-0.1.0/l/cardano-extras/doc/html/cem-script/src/Plutus.Extras.html#scriptValidatorHash"><span class="hs-identifier hs-var">scriptValidatorHash</span></a></span><span> </span><span class="annot"><span class="annottext">(SerialisedScript -&gt; ScriptHash)
-&gt; (Proxy script -&gt; SerialisedScript) -&gt; Proxy script -&gt; ScriptHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy script -&gt; SerialisedScript
forall script.
CEMScriptCompiled script =&gt;
Proxy script -&gt; SerialisedScript
</span><a href="Cardano.CEM.OnChain.html#cemScriptCompiled"><span class="hs-identifier hs-var">cemScriptCompiled</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">type</span><span> </span><span id="IsData"><span class="annot"><a href="Cardano.CEM.OnChain.html#IsData"><span class="hs-identifier hs-var">IsData</span></a></span></span><span> </span><span id="local-6989586621679556891"><span class="annot"><a href="#local-6989586621679556891"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#UnsafeFromData"><span class="hs-identifier hs-type">UnsafeFromData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556891"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#FromData"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556891"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#ToData"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556891"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="CEMScriptIsData"><span class="annot"><a href="Cardano.CEM.OnChain.html#CEMScriptIsData"><span class="hs-identifier hs-var">CEMScriptIsData</span></a></span></span><span> </span><span id="local-6989586621679556892"><span class="annot"><a href="#local-6989586621679556892"><span class="hs-identifier hs-type">script</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#UnsafeFromData"><span class="hs-identifier hs-type">UnsafeFromData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#Transition"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556892"><span class="hs-identifier hs-type">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#IsData"><span class="hs-identifier hs-type">IsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.Stages.html#StageParams"><span class="hs-identifier hs-type">StageParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#Stage"><span class="hs-identifier hs-type">Stage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556892"><span class="hs-identifier hs-type">script</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#IsData"><span class="hs-identifier hs-type">IsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556892"><span class="hs-identifier hs-type">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#IsData"><span class="hs-identifier hs-type">IsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#Transition"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556892"><span class="hs-identifier hs-type">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#IsData"><span class="hs-identifier hs-type">IsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556892"><span class="hs-identifier hs-type">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Various hacks and type annotations are done due to Plutus limitations</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- Typed quasi-quotes do not allow type splicing, so we need use untyped</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- Fields bug - https://gitlab.haskell.org/ghc/ghc/-/merge_requests/8686</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- Data family - not supported -</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- https://github.com/IntersectMBO/plutus/issues/5768</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- Type family mentioning: https://github.com/IntersectMBO/plutus/issues/5769</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#genericCEMScript"><span class="hs-pragma hs-type">genericCEMScript</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Cardano.CEM.OnChain.html#genericCEMScript"><span class="hs-identifier hs-type">genericCEMScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-71"></span><span id="genericCEMScript"><span class="annot"><span class="annottext">genericCEMScript :: Name -&gt; Name -&gt; Q Exp
</span><a href="Cardano.CEM.OnChain.html#genericCEMScript"><span class="hs-identifier hs-var hs-var">genericCEMScript</span></a></span></span><span> </span><span id="local-6989586621679556898"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556898"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span id="local-6989586621679556899"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556899"><span class="hs-identifier hs-var">scriptStage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">[|</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679556900"><span class="annot"><a href="#local-6989586621679556900"><span class="hs-identifier hs-var">datum'</span></a></span></span><span> </span><span id="local-6989586621679556901"><span class="annot"><a href="#local-6989586621679556901"><span class="hs-identifier hs-var">redeemer'</span></a></span></span><span> </span><span id="local-6989586621679556902"><span class="annot"><a href="#local-6989586621679556902"><span class="hs-identifier hs-var">context'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-75"></span><span>        </span><span id="local-6989586621679556903"><span class="annot"><a href="#local-6989586621679556903"><span class="hs-identifier hs-var hs-var">checkTxFan'</span></a></span></span><span> </span><span id="local-6989586621679556904"><span class="annot"><a href="#local-6989586621679556904"><span class="hs-identifier hs-var">filterSpec'</span></a></span></span><span> </span><span id="local-6989586621679556905"><span class="annot"><a href="#local-6989586621679556905"><span class="hs-identifier hs-var">fan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679556904"><span class="hs-identifier hs-type">filterSpec'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-77"></span><span>            </span><span class="annot"><a href="Cardano.CEM.html#Anything"><span class="hs-identifier hs-type">Anything</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-78"></span><span>            </span><span class="annot"><a href="Cardano.CEM.html#UnsafeBySameCEM"><span class="hs-identifier hs-type">UnsafeBySameCEM</span></a></span><span> </span><span id="local-6989586621679556908"><span class="annot"><a href="#local-6989586621679556908"><span class="hs-identifier hs-var">stateData</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>              </span><span class="hs-keyword">let</span><span>
</span><span id="line-80"></span><span>                </span><span class="hs-comment">-- FIXUP: do not decode unnecessary</span><span>
</span><span id="line-81"></span><span>                </span><span id="local-6989586621679556909"><span class="annot"><a href="#local-6989586621679556909"><span class="hs-identifier hs-var hs-var">changedState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-82"></span><span>                  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#unsafeFromBuiltinData"><span class="hs-identifier hs-type">unsafeFromBuiltinData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556908"><span class="hs-identifier hs-type">stateData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CEM.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556898"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>                </span><span id="local-6989586621679556911"><span class="annot"><a href="#local-6989586621679556911"><span class="hs-identifier hs-var hs-var">stateChangeDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679556912"><span class="hs-identifier hs-type">stageParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679556913"><span class="hs-identifier hs-type">params</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679556908"><span class="hs-identifier hs-type">stateData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>                </span><span id="local-6989586621679556914"><span class="annot"><a href="#local-6989586621679556914"><span class="hs-identifier hs-var hs-var">stateChangeDatumBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#toBuiltinData"><span class="hs-identifier hs-type">toBuiltinData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556911"><span class="hs-identifier hs-type">stateChangeDatum</span></a></span><span>
</span><span id="line-85"></span><span>               </span><span class="hs-keyword">in</span><span>
</span><span id="line-86"></span><span>                </span><span class="annot"><a href="#local-6989586621679556903"><span class="hs-identifier hs-type">checkTxFan'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#ByDatum"><span class="hs-identifier hs-type">ByDatum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556914"><span class="hs-identifier hs-type">stateChangeDatumBS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679556905"><span class="hs-identifier hs-type">fan</span></a></span><span>
</span><span id="line-87"></span><span>            </span><span class="annot"><a href="Cardano.CEM.html#ByDatum"><span class="hs-identifier hs-type">ByDatum</span></a></span><span> </span><span id="local-6989586621679556916"><span class="annot"><a href="#local-6989586621679556916"><span class="hs-identifier hs-var">expectedDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>              </span><span class="hs-keyword">let</span><span>
</span><span id="line-89"></span><span>                </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679556918"><span class="annot"><a href="#local-6989586621679556918"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679556905"><span class="hs-identifier hs-type">fan</span></a></span><span>
</span><span id="line-90"></span><span>               </span><span class="hs-keyword">in</span><span>
</span><span id="line-91"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679556918"><span class="hs-identifier hs-type">datum</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>                  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#OutputDatum"><span class="hs-identifier hs-type">OutputDatum</span></a></span><span> </span><span id="local-6989586621679556920"><span class="annot"><a href="#local-6989586621679556920"><span class="hs-identifier hs-var">datumContent</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-93"></span><span>                    </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Scripts.html#getDatum"><span class="hs-identifier hs-var">getDatum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556920"><span class="hs-identifier hs-type">datumContent</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Eq.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556916"><span class="hs-identifier hs-type">expectedDatum</span></a></span><span>
</span><span id="line-94"></span><span>                  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#OutputDatumHash"><span class="hs-identifier hs-type">OutputDatumHash</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Trace.html#traceError"><span class="hs-identifier hs-type">traceError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Hash datum not supported&quot;</span></span><span>
</span><span id="line-95"></span><span>                  </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-96"></span><span>        </span><span id="local-6989586621679556925"><span class="annot"><a href="#local-6989586621679556925"><span class="hs-identifier hs-var hs-var">checkConstraint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#MkTxFanC"><span class="hs-identifier hs-type">MkTxFanC</span></a></span><span> </span><span id="local-6989586621679556927"><span class="annot"><a href="#local-6989586621679556927"><span class="hs-identifier hs-var">fanKind</span></a></span></span><span> </span><span id="local-6989586621679556928"><span class="annot"><a href="#local-6989586621679556928"><span class="hs-identifier hs-var">filterSpec</span></a></span></span><span> </span><span id="local-6989586621679556929"><span class="annot"><a href="#local-6989586621679556929"><span class="hs-identifier hs-var">quantifier</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>          </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Trace.html#traceIfFalse"><span class="hs-identifier hs-type">traceIfFalse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Checking constraint &quot;</span></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Semigroup.html#%3C%3E"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Show.TH.html#show"><span class="hs-identifier hs-type">show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556927"><span class="hs-identifier hs-type">fanKind</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Semigroup.html#%3C%3E"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Semigroup.html#%3C%3E"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Show.TH.html#show"><span class="hs-identifier hs-type">show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556933"><span class="hs-identifier hs-type">datumSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>            </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556935"><span class="hs-identifier hs-type">checkQuantifier</span></a></span><span>
</span><span id="line-99"></span><span>            </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.List.html#filter"><span class="hs-identifier hs-type">filter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556937"><span class="hs-identifier hs-type">checkTxFan</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556938"><span class="hs-identifier hs-type">fans</span></a></span><span>
</span><span id="line-100"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><a href="Cardano.CEM.html#MkTxFanFilter"><span class="hs-identifier hs-type">MkTxFanFilter</span></a></span><span> </span><span id="local-6989586621679556940"><span class="annot"><a href="#local-6989586621679556940"><span class="hs-identifier hs-var">addressSpec</span></a></span></span><span> </span><span id="local-6989586621679556933"><span class="annot"><a href="#local-6989586621679556933"><span class="hs-identifier hs-var">datumSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679556928"><span class="hs-identifier hs-type">filterSpec</span></a></span><span>
</span><span id="line-102"></span><span>            </span><span id="local-6989586621679556937"><span class="annot"><a href="#local-6989586621679556937"><span class="hs-identifier hs-var hs-var">checkTxFan</span></a></span></span><span> </span><span id="local-6989586621679556941"><span class="annot"><a href="#local-6989586621679556941"><span class="hs-identifier hs-var">fan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>              </span><span class="annot"><a href="Cardano.CEM.OnChain.html#checkTxFanAddress"><span class="hs-identifier hs-type">checkTxFanAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556943"><span class="hs-identifier hs-type">ownAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556940"><span class="hs-identifier hs-type">addressSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556941"><span class="hs-identifier hs-type">fan</span></a></span><span>
</span><span id="line-104"></span><span>                </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Bool.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556903"><span class="hs-identifier hs-type">checkTxFan'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556933"><span class="hs-identifier hs-type">datumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556941"><span class="hs-identifier hs-type">fan</span></a></span><span>
</span><span id="line-105"></span><span>            </span><span id="local-6989586621679556938"><span class="annot"><a href="#local-6989586621679556938"><span class="hs-identifier hs-var hs-var">fans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679556927"><span class="hs-identifier hs-type">fanKind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-106"></span><span>              </span><span class="annot"><a href="Cardano.CEM.html#In"><span class="hs-identifier hs-type">In</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.List.html#map"><span class="hs-identifier hs-type">map</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#txInInfoResolved"><span class="hs-identifier hs-var">txInInfoResolved</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#txInfoInputs"><span class="hs-identifier hs-var">txInfoInputs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556949"><span class="hs-identifier hs-type">info</span></a></span><span>
</span><span id="line-107"></span><span>              </span><span class="annot"><a href="Cardano.CEM.html#InRef"><span class="hs-identifier hs-type">InRef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.List.html#map"><span class="hs-identifier hs-type">map</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#txInInfoResolved"><span class="hs-identifier hs-var">txInInfoResolved</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#txInfoReferenceInputs"><span class="hs-identifier hs-var">txInfoReferenceInputs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556949"><span class="hs-identifier hs-type">info</span></a></span><span>
</span><span id="line-108"></span><span>              </span><span class="annot"><a href="Cardano.CEM.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#txInfoOutputs"><span class="hs-identifier hs-var">txInfoOutputs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556949"><span class="hs-identifier hs-type">info</span></a></span><span>
</span><span id="line-109"></span><span>            </span><span id="local-6989586621679556935"><span class="annot"><a href="#local-6989586621679556935"><span class="hs-identifier hs-var hs-var">checkQuantifier</span></a></span></span><span> </span><span id="local-6989586621679556954"><span class="annot"><a href="#local-6989586621679556954"><span class="hs-identifier hs-var">txFans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679556929"><span class="hs-identifier hs-type">quantifier</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-111"></span><span>                </span><span class="annot"><a href="Cardano.CEM.html#SumValueEq"><span class="hs-identifier hs-type">SumValueEq</span></a></span><span> </span><span id="local-6989586621679556956"><span class="annot"><a href="#local-6989586621679556956"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-112"></span><span>                  </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Foldable.html#foldMap"><span class="hs-identifier hs-type">foldMap</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#txOutValue"><span class="hs-identifier hs-var">txOutValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556954"><span class="hs-identifier hs-type">txFans</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Value.html#geq"><span class="hs-operator hs-type">`geq`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556956"><span class="hs-identifier hs-type">value</span></a></span><span>
</span><span id="line-113"></span><span>                </span><span class="annot"><a href="Cardano.CEM.html#Exist"><span class="hs-identifier hs-type">Exist</span></a></span><span> </span><span id="local-6989586621679556960"><span class="annot"><a href="#local-6989586621679556960"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Foldable.html#length"><span class="hs-identifier hs-type">length</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556954"><span class="hs-identifier hs-type">txFans</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Eq.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556960"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><a href="#local-6989586621679556913"><span class="hs-identifier hs-type">params</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CEM.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556898"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="#local-6989586621679556912"><span class="hs-identifier hs-type">stageParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CEM.Stages.html#StageParams"><span class="hs-identifier hs-type">StageParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556899"><span class="hs-identifier hs-var">scriptStage</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><a href="#local-6989586621679556962"><span class="hs-identifier hs-type">ownDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CEM.html#CEMScriptDatum"><span class="hs-identifier hs-type">CEMScriptDatum</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556898"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>        </span><span id="local-6989586621679556962"><span class="annot"><a href="#local-6989586621679556962"><span class="hs-identifier hs-var hs-var">ownDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#unsafeFromBuiltinData"><span class="hs-identifier hs-type">unsafeFromBuiltinData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556900"><span class="hs-identifier hs-type">datum'</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679556912"><span class="annot"><a href="#local-6989586621679556912"><span class="hs-identifier hs-var">stageParams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679556913"><span class="annot"><a href="#local-6989586621679556913"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679556964"><span class="annot"><a href="#local-6989586621679556964"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679556962"><span class="hs-identifier hs-type">ownDatum</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><a href="#local-6989586621679556965"><span class="hs-identifier hs-type">transition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CEM.html#Transition"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556898"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>        </span><span id="local-6989586621679556965"><span class="annot"><a href="#local-6989586621679556965"><span class="hs-identifier hs-var hs-var">transition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#unsafeFromBuiltinData"><span class="hs-identifier hs-type">unsafeFromBuiltinData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556901"><span class="hs-identifier hs-type">redeemer'</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span id="local-6989586621679556966"><span class="annot"><a href="#local-6989586621679556966"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.IsData.Class.html#unsafeFromBuiltinData"><span class="hs-identifier hs-type">unsafeFromBuiltinData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556902"><span class="hs-identifier hs-type">context'</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621679556949"><span class="annot"><a href="#local-6989586621679556949"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#scriptContextTxInfo"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556966"><span class="hs-identifier hs-type">context</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span id="local-6989586621679556943"><span class="annot"><a href="#local-6989586621679556943"><span class="hs-identifier hs-var hs-var">ownAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#findOwnInput"><span class="hs-identifier hs-type">findOwnInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556966"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-125"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679556967"><span class="annot"><a href="#local-6989586621679556967"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#txOutAddress"><span class="hs-identifier hs-var">txOutAddress</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#txInInfoResolved"><span class="hs-identifier hs-var">txInInfoResolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556967"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-126"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Trace.html#traceError"><span class="hs-identifier hs-type">traceError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Impossible happened&quot;</span></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621679556969"><span class="annot"><a href="#local-6989586621679556969"><span class="hs-identifier hs-var hs-var">transitionSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.CEM.html#transitionSpec"><span class="hs-identifier hs-type">transitionSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556898"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621679556971"><span class="annot"><a href="#local-6989586621679556971"><span class="hs-identifier hs-var hs-var">stageToOnChainInterval'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.CEM.Stages.html#stageToOnChainInterval"><span class="hs-identifier hs-type">stageToOnChainInterval</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556899"><span class="hs-identifier hs-var">scriptStage</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>        </span><span id="local-6989586621679556973"><span class="annot"><a href="#local-6989586621679556973"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679556969"><span class="hs-identifier hs-type">transitionSpec'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556913"><span class="hs-identifier hs-type">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679556964"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679556965"><span class="hs-identifier hs-type">transition</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CEM.html#MkTransitionSpec"><span class="hs-identifier hs-type">MkTransitionSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679556898"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679556975"><span class="annot"><a href="#local-6989586621679556975"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679556976"><span class="annot"><a href="#local-6989586621679556976"><span class="hs-identifier hs-var">signers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>              </span><span class="hs-comment">-- do transition</span><span>
</span><span id="line-133"></span><span>              </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Trace.html#traceIfFalse"><span class="hs-identifier hs-type">traceIfFalse</span></a></span><span>
</span><span id="line-134"></span><span>                </span><span class="annot"><span class="hs-string">&quot;Some constraint not matching&quot;</span></span><span>
</span><span id="line-135"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.List.html#all"><span class="hs-identifier hs-type">all</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556925"><span class="hs-identifier hs-type">checkConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556975"><span class="hs-identifier hs-type">constraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>                </span><span class="hs-comment">-- check signers</span><span>
</span><span id="line-137"></span><span>                </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Bool.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Trace.html#traceIfFalse"><span class="hs-identifier hs-type">traceIfFalse</span></a></span><span>
</span><span id="line-138"></span><span>                  </span><span class="annot"><span class="hs-string">&quot;Wrong signers list&quot;</span></span><span>
</span><span id="line-139"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679556976"><span class="hs-identifier hs-type">signers</span></a></span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#isSubSetOf"><span class="hs-operator hs-type">`isSubSetOf`</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#txInfoSignatories"><span class="hs-identifier hs-var">txInfoSignatories</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556949"><span class="hs-identifier hs-type">info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>                </span><span class="hs-comment">-- check stage</span><span>
</span><span id="line-141"></span><span>                </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Bool.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-142"></span><span>                    </span><span id="local-6989586621679556980"><span class="annot"><a href="#local-6989586621679556980"><span class="hs-identifier hs-var hs-var">expectedInterval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>                      </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Interval.html#always"><span class="hs-identifier hs-type">always</span></a></span><span>
</span><span id="line-144"></span><span>                      </span><span class="hs-comment">-- stageToOnChainInterval' stageParams (traceError &quot;TODO&quot;)</span><span>
</span><span id="line-145"></span><span>                    </span><span class="hs-keyword">in</span><span>
</span><span id="line-146"></span><span>                    </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Trace.html#traceIfFalse"><span class="hs-identifier hs-type">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Wrong interval for transition stage&quot;</span></span><span>
</span><span id="line-147"></span><span>                      </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556980"><span class="hs-identifier hs-type">expectedInterval</span></a></span><span>
</span><span id="line-148"></span><span>                      </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Interval.html#contains"><span class="hs-operator hs-type">`contains`</span></a></span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Contexts.html#txInfoValidRange"><span class="hs-identifier hs-var">txInfoValidRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556949"><span class="hs-identifier hs-type">info</span></a></span><span>
</span><span id="line-149"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Trace.html#traceIfFalse"><span class="hs-identifier hs-type">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Wrong transition&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-150"></span><span>       </span><span class="hs-keyword">in</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679556973"><span class="hs-identifier hs-type">result</span></a></span><span>
</span><span id="line-152"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Builtins.html#error"><span class="hs-identifier hs-type">error</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">|]</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#checkTxFanAddress"><span class="hs-pragma hs-type">checkTxFanAddress</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-157"></span><span class="annot"><a href="Cardano.CEM.OnChain.html#checkTxFanAddress"><span class="hs-identifier hs-type">checkTxFanAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V1.Address.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.CEM.html#AddressSpec"><span class="hs-identifier hs-type">AddressSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-158"></span><span id="checkTxFanAddress"><span class="annot"><span class="annottext">checkTxFanAddress :: Address -&gt; AddressSpec -&gt; TxOut -&gt; Bool
</span><a href="Cardano.CEM.OnChain.html#checkTxFanAddress"><span class="hs-identifier hs-var hs-var">checkTxFanAddress</span></a></span></span><span> </span><span id="local-6989586621679556983"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679556983"><span class="hs-identifier hs-var">ownAddress</span></a></span></span><span> </span><span id="local-6989586621679556984"><span class="annot"><span class="annottext">AddressSpec
</span><a href="#local-6989586621679556984"><span class="hs-identifier hs-var">addressSpec</span></a></span></span><span> </span><span id="local-6989586621679556985"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679556985"><span class="hs-identifier hs-var">fan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="annottext">TxOut -&gt; Address
</span><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-ledger-api-1.21.0.0-1b57f518c9186e0f88796bb5ca61ae8aad79286aaddc760c0b547f08904e829b/share/doc/html/src/PlutusLedgerApi.V2.Tx.html#txOutAddress"><span class="hs-identifier hs-var">txOutAddress</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679556985"><span class="hs-identifier hs-var">fan</span></a></span><span> </span><span class="annot"><span class="annottext">Address -&gt; Address -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Eq.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Address -&gt; AddressSpec -&gt; Address
</span><a href="Cardano.CEM.html#addressSpecToAddress"><span class="hs-identifier hs-var">addressSpecToAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679556983"><span class="hs-identifier hs-var">ownAddress</span></a></span><span> </span><span class="annot"><span class="annottext">AddressSpec
</span><a href="#local-6989586621679556984"><span class="hs-identifier hs-var">addressSpec</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Cardano.CEM.OnChain.html#isSubSetOf"><span class="hs-pragma hs-type">isSubSetOf</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-162"></span><span id="local-6989586621679556850"><span class="annot"><a href="Cardano.CEM.OnChain.html#isSubSetOf"><span class="hs-identifier hs-type">isSubSetOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.Eq.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679556850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679556850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679556850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-163"></span><span id="isSubSetOf"><span class="annot"><span class="annottext">isSubSetOf :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="Cardano.CEM.OnChain.html#isSubSetOf"><span class="hs-identifier hs-var hs-var">isSubSetOf</span></a></span></span><span> </span><span id="local-6989586621679556989"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679556989"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679556990"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679556990"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; Bool
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Bool
</span><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.List.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
</span><a href="file:///home/gregory/.cabal/store/ghc-9.6.3/plutus-tx-1.21.0.0-3d2b6b90b431fd10c385af250c9cbf5353d9dd2c7b595a24bf8345c705ac5ca0/share/doc/html/src/PlutusTx.List.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679556990"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679556989"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-164"></span></pre></body></html>